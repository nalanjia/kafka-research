胡夕 2019-06-03

你好，我是胡夕，Apache Kafka 的一名代码贡献者，目前在社区的 Patch 提交总数位列第 22 位，应该说算是国内比较活跃的贡献者了。

在过去 5 年中，我经历了 Kafka 从最初的 0.8 版本逐步演进到现在的 2.3 版本的完整过程，踩了很多坑也交了很多学费，慢慢地我梳理出了一个相对系统、完整的 Kafka 应用实战指南，最终以“Kafka 核心技术与实战”专栏的形式呈现给你，希望分享我对 Apache Kafka 的理解和实战方面的经验，帮你透彻理解 Kafka、更好地应用 Kafka。

你可能会有这样的疑问，我为什么要学习 Kafka 呢？要回答这个问题，我们不妨从更大的视角来审视它，先聊聊我对这几年互联网技术发展的理解吧。

互联网蓬勃发展的这些年涌现出了很多令人眼花缭乱的新技术。以我个人的浅见，截止到 2019 年，当下互联网行业最火的技术当属 ABC 了，即所谓的 AI 人工智能、BigData 大数据和 Cloud 云计算云平台。我个人对区块链技术发展前景存疑，毕竟目前没有看到特别好的落地应用场景，也许在未来几年它会更令人刮目相看吧。

在这 ABC 当中，坦率说 A 和 C 是有点曲高和寡的，不是所有玩家都能入场。反观 B 要显得平民得多，几乎所有公司都能参与进来。我曾经到过一个理发厅，那里的人都宣称他们采用了大数据系统帮助客户设计造型，足见 BigData 是很“下里巴人”的。

作为工程师或架构师，你在实际工作过程中一定参与到了很多大数据业务系统的构建。由于这些系统都是为公司业务服务的，所以通常来说它们仅仅是执行一些常规的业务逻辑，因此它们不能算是计算密集型应用，相反更应该是数据密集型的。

对于数据密集型应用来说，如何应对数据量激增、数据复杂度增加以及数据变化速率变快，是彰显大数据工程师、架构师功力的最有效表征。我们欣喜地发现 Kafka 在帮助你应对这些问题方面能起到非常好的效果。就拿数据量激增来说，Kafka 能够有效隔离上下游业务，将上游突增的流量缓存起来，以平滑的方式传导到下游子系统中，避免了流量的不规则冲击。由此可见，如果你是一名大数据从业人员，熟练掌握 Kafka 是非常必要的一项技能。

刚刚所举的例子仅仅是 Kafka 助力业务的一个场景罢了。事实上，Kafka 有着非常广阔的应用场景。不谦虚地说，目前 Apache Kafka 被认为是整个消息引擎领域的执牛耳者，仅凭这一点就值得我们好好学习一下它。另外，从学习技术的角度而言，Kafka 也是很有亮点的。我们仅需要学习一套框架就能在实际业务系统中实现消息引擎应用、应用程序集成、分布式存储构建，甚至是流处理应用的开发与部署，听起来还是很超值的吧。

不仅如此，再给你看一个数据。援引美国 2019 年 Dice 技术薪资报告中的数据，在 10 大薪资最高的技术技能中，掌握 Kafka 以平均每年 12.8 万美元排名第二！排名第一位的是 13.2 万美元 / 年的 Go 语言。好吧，希望你看到这个之后不会立即关闭我的专栏然后转头直奔隔壁的 Go 语言专栏。虽然这是美国人才市场的数据，但是我们有理由相信在国内 Kafka 的行情也是水涨船高。2019 年两会上再一次提到了要深化大数据、人工智能等研发应用，而 Kafka 无论是作为消息引擎还是实时流处理平台，都能在大数据工程领域发挥重要的作用。

总之 Kafka 是个利器，值得一试！既然知道了为什么要学 Kafka，那我们就要行动起来，把它学透，而学透 Kafka 有什么路径吗？

如果你是一名软件开发工程师的话，掌握 Kafka 的第一步就是要根据你掌握的编程语言去寻找对应的 Kafka 客户端。当前 Kafka 最重要的两大客户端是 Java 客户端和 libkafka 客户端，它们更新和维护的速度很快，非常适合你持续花时间投入。

一旦确定了要使用的客户端，马上去官网上学习一下代码示例，如果能够正确编译和运行这些样例，你就能轻松地驾驭客户端了。

下一步你可以尝试修改样例代码尝试去理解并使用其他的 API，之后观测你修改的结果。如果这些都没有难倒你，你可以自己编写一个小型项目来验证下学习成果，然后就是改善和提升客户端的可靠性和性能了。到了这一步，你可以熟读一遍 Kafka 官网文档，确保你理解了那些可能影响可靠性和性能的参数。

最后是学习 Kafka 的高级功能，比如流处理应用开发。流处理 API 不仅能够生产和消费消息，还能执行高级的流式处理操作，比如时间窗口聚合、流处理连接等。

如果你是系统管理员或运维工程师，那么相应的学习目标应该是学习搭建及管理 Kafka 线上环境。如何根据实际业务需求评估、搭建生产线上环境将是你主要的学习目标。另外对生产环境的监控也是重中之重的工作，Kafka 提供了超多的 JMX 监控指标，你可以选择任意你熟知的框架进行监控。有了监控数据，作为系统运维管理员的你，势必要观测真实业务负载下的 Kafka 集群表现。之后如何利用已有的监控指标来找出系统瓶颈，然后提升整个系统的吞吐量，这也是最能体现你工作价值的地方。

在明确了自己要学什么以及怎么学之后，你现在会不会有一种感慨：原来我要学习这么多东西呀！不用担心，刚刚我提到的所有内容都会在专栏中被覆盖到。

下面是我特意为专栏画的一张思维导图，可以帮你迅速了解这个专栏的知识结构体系是什么样的。专栏大致从六个方面展开，包括 Kafka 入门、Kafka 的基本使用、客户端详解、Kafka 原理介绍、Kafka 运维与监控以及高级 Kafka 应用。
【1-配图-思维导图.jpg】

专栏的第一部分我会介绍消息引擎这类系统大致的原理和用途，以及作为优秀消息引擎代表的 Kafka 在这方面的表现。

第二部分则重点探讨 Kafka 如何用于生产环境，特别是线上环境方案的制定。

在第三部分中我会陪你一起学习 Kafka 客户端的方方面面，既有生产者的实操讲解也有消费者的原理剖析，你一定不要错过。

第四部分会着重介绍 Kafka 最核心的设计原理，包括 Controller 的设计机制、请求处理全流程解析等。

第五部分则涵盖 Kafka 运维与监控的内容，想获得高效运维 Kafka 集群以及有效监控 Kafka 的实战经验？我必当倾囊相助！

最后一个部分我会简单介绍一下 Kafka 流处理组件 Kafka Streams 的实战应用，希望能让你认识一个不太一样的 Kafka。

这里不得不提的是，有熟悉我的读者可能知道我出版过的图书《Apache Kafka 实战》。你可能有这样的疑问：既然有书了，那么这个专栏与书的区别又是什么呢？《Apache Kafka 实战》这本书是基于 Kafka 1.0 版本撰写的，但目前 Kafka 已经演进到 2.3 版本了，我必须要承认书中的部分内容已经过时甚至是不准确了，而专栏的写作是基于 Kafka 的最新版。并且专栏作为一次全新的交付，我希望能用更轻松更容易理解的语言和形式，帮你获取到最新的 Kafka 实战经验。

我希望通过学习这个专栏，你不仅能够将 Kafka 熟练运用到实际工作当中去，而且还能培养出对于 Kafka 或是其他技术框架的浓厚学习兴趣。

最后我希望用一句话收尾与你共勉：Stay focused and work hard！

精选留言(66)


阿武
老师 发量 保持的还不错！
2019-06-03


88

大番茄
1.希望老师 讲下rabbitmq和kafka区别，传统企业如何选择?

2. 课程更新周期是怎么样的？

3. 学习这个课，老师能推荐些辅助资料么？

🙏感谢
2019-06-04

1

29

Fan
Stay focused and work hard！
作者回复: 特别喜欢这句话：）
2019-06-03


10

jeffery
书+专栏更完美、期待蜕变
作者回复: 感谢支持与鼓励：） 我们一起学习
2019-06-03


6

默无闻
老师，我恰好会go语言，再加上kafka是不是碉堡了！
作者回复: 莫老板别闹：）
2019-06-12


5

paradox
相比人工智能和区块链，大数据和云计算成熟很多。云计算的成熟，又促成了大数据技术的大规模普及。不过真正有“大”数据的公司并不多。
2019-06-03


5

kaiux
这个专栏等了一段时间了，前段时间正好在学习Kafka，后期会用到项目实践中，期待能有一个深入的理解。
作者回复: 感谢支持与鼓励：）期待你的反馈我们一起学习~~
2019-06-03


5

侯代烨
我们的kafka集群，每个节点只能存储35G的数据量，超过这个量之后，kafka进程就会挂掉，启动会报内存溢出的错误，困扰很久了，不知道学习了这个课程，能不能解决这个问题。
作者回复: 后面会有性能调优的部分。分析性能问题还是要结合具体 的错误来看，比如内存溢出要明确是哪部分内存溢出，然后才有可能有针对性的调整
2019-06-05


4

小北
希望后续会有php以及go客户端的讲解
2019-06-04


4

Geek_e5967d
赞一个，最近开始学习kafka运维，我们使用的还是用的0.8.1版本😿
2019-06-03


4

开水
老师，后续课程中会对比一下其他消息框架么。比如rocket，rabbit
作者回复: 坦率说不会有太多涉及，毕竟还是以介绍Apache Kafka为主
2019-06-05


3

Fouy_飞虎
赞一个，正准备深入学习一下。
作者回复: 感谢支持与鼓励：）
2019-06-03


3

风中花
开场白，让我觉得学习动力好大啊，我是做。net 感觉客户端貌似没有提到啊，等后续期待老师提到一些，相关知识。谢谢
作者回复: 坦率说专栏对客户端的介绍主要还是以java为主。另外官网上列出的7个.NET客户端有6个已经不维护了，建议还是直接使用Confluent公司自己维护的那个.NET客户端吧。
2019-06-11


2

roger
有新出比kafka更灵活的消息队列吗？
作者回复: 不确定百分之百理解了“灵活”的含义，不过可以关注下Apache Pulsar
2019-06-05


2

Alexdown
期待，同时期望老师在专栏中穿插一些高频的面试题 ——作为消息中间件使用时，消息的可靠传输、顺序，重复消费等问题在kafka中是如何解决的。这不仅仅对面试有帮助，也对进入公司后快速上手熟悉系统、排查线上问题等有帮助，谢谢
作者回复: 嗯嗯，专栏中有些文章的标题就是常见的面试题。比如消息无丢失配置，再比如消费者组rebalance过程等，可以关注下~~
2019-06-04


2

Hwan
专栏已经更新完了，想问下老师，作为开发在学习Kafka的时候的侧重点在哪些方面呢，比如运维那部分是不是了解就行呢
作者回复: 可以关注下性能方面的问题。普通的kafka开发我觉得大家应该都能熟练掌握了
2019-11-07


1

robbin🐳
老师，我之前有老大和我说他们之前用kafka在量大的时候会丢数据，但我在网上和自己使用中并未遇到，想问老师是真的会有丢数据的情况吗？
作者回复: 我们这边量也很大，但是没有碰到过丢消息。可能还是配置的问题。当然Kafka重复消息倒是常见
2019-07-23


1

流浪的阳光
老师您好，请问kafca适合做两个系统之间的转账处理吗？

另外，请问kafca的使用案例中，最多支持过什么数量级的消费者和生产者。
作者回复: 坦率说不合适，还是让数据库做吧~

你指的数量级是什么呢？如果是消息数，每天数十亿的系统我就接触过。国内大厂怕是更多了
2019-07-03


1

非想
又多了解一个中间件，加油。
2019-07-01


1

October
跟上老师的步伐，stay focused and work hard，希望能对Apache Kafka有一个全新的理解与认知。
作者回复: 共勉！我自己在写的过程中也学到了不少：）
2019-06-16


1

wxr
期待早点讲到监控这一章，作为运维，对监控的需求很迫切。现在只知道监控broker的jmx端口参数，另外用burrow监控过消费延时，但光这些监控还是感觉太少。最近有监控rabalance发生情况的需求，还没有思路。
作者回复: 坦率说目前Kafka的免费监控方案没有特别好的，到时候我们一起聊聊。
2019-06-16


1

傲
终于等到了kafka的专栏！老师，要是想系统学习下kafka源码，是不是要先学下scala？
作者回复: 其实不太需要。Kafka源码并没有用到Scala那些很高级的语言特性，比如Curry等。如果你了解Java 8的Stream就能够理解Kafka中大部分的Scala语法了。
2019-06-11


1

roxy
最近公司刚部署了kafka，正在验证和优化阶段，专栏出的刚刚好，跟着老师一起学习
2019-06-10


1

小猪
老师的课程会讲kafka在k8s平台的部署、运维和实践吗？
作者回复: 嗯嗯，很抱歉，目前没有涉及Kafka在Docker、K8S或是云上的介绍~~
2019-06-10


1

Monday
1，希望通过本专栏深入理解kafka的原理。
2，消息中间件的面试可以搞掂。
2019-06-08


1

绝影
跟着老师，系统学习kafka
作者回复: 看头像貌似是个熟人：）
2019-06-06


1

Michael
老师 这个专栏是从最初级的入门开始的嘛？怕后面听不懂，没接触过
作者回复: 专栏前面有一些术语和基本概念的介绍。如果没接触过可以采用这样的学习方法：先把专栏中基本概念和术语搞懂，然后一点点实践专栏后面的内容，跟着专栏一起学：）
2019-06-05


1

虹桥念苏
一直在看Flink，感觉Kafka还是深入了解一下比较好，不知道胡老师会不会带一些pulsar比较，这个后起之秀不能忽视，谢谢！
作者回复: 我和Pulsar的郭总、翟总都相识，都Pulsar不敢妄言比较，但我同意Apache Pulsar是一款非常优秀的消息引擎：）
2019-06-04


1

huaweichen
老师的Kafka Stream是不是讲得有点少？
作者回复: 嗯嗯，目前Kafka Streams还在积极演进中。我挑了一些已经比较稳定的功能来讲
2019-06-04


1

QQ怪
期待老师kafka专栏很久了，一定会倾全力学习😁
2019-06-04


1

zhisheng
老师，你好，到时候你讲的时候是使用Java api 还是Scala api 啊？
作者回复: 我们都是使用Java客户端。其实就客户端API来说，没有特定的Scala API，因为Scala也是直接调用Java API。当然社区最近为Kafka Streams推出了Sacla wrapper，即可以直接用Scala编写Kafka Streams应用。
2019-06-04


1

liubiqianmoney
会连带讲一讲Zookeeper吗？
作者回复: ZooKeeper部分有零星涉及，主要是谈到Controller时有讲到
2019-06-04


1

张成
给胡老师点个赞！
作者回复: 感谢成哥的鼓励：）
2019-06-03


1

Hurt
老师 kafka适用于别别的语言吗
作者回复: 除了Java/Scala客户端，社区还有一个强维护的C++客户端：librdkafka。最近这个客户端的作者也被收编进Kafka商业公司Confluent，质量上是有保证的。另外很多其他语言的客户端也是基于librdkafka的， 比如Python等
2019-06-03


1

Geek_3b601e
一直听说过kafka，但是我原来确实不知道，这个得作用。看见了这个专栏立即买了
作者回复: 感谢支持与鼓励：）
2019-06-03


1

未未的未来
项目中要用kafka，特来学习一下。
2019-10-13



郑李孔明
请问国内有kafka交流的微信群或者qq群吗？求拉群，交流学习
作者回复: qq群：162272557
微信群：Apache Kafka 交流群（已满，需要人拉进来）
2019-08-29

1


常银玲
学习新的知识，势必会和已知类似的知识进行比对，想要了解学习kafka，那我需要知道kafka特定场景下优于其他消息引擎的优势，rabbtimq和rocketmq和kafka非常重要的区分点在于顺序追加磁盘，客户端零拷贝加大了吞吐量，负载均衡这些，那他特定的场景在于哪里，我不知道我写的全不全，或者有没有错误，希望老师解答一下
2019-08-17



godtrue
Stay focused and work hard！
又要开始一段新的旅程，希望看到一路美轮美奂丰富多彩的风景。
kafka 久仰大名未曾谋面，这次希望对她多一些了解。
目前对消息队列中间的理解
1：作用——系统解藕，流量削峰填谷
2：本质——生产者消费者模式的经典实现
3：目前听说的有rocketMQ/rabbitMQ，相信大厂都有自研的
4：感觉使用比较简单
我希望通过本专栏的学习，能了解到，如下内容
1：kafka的使用以及监控和问题分析与排查？
2：听说kafka比较牛逼，它到底优秀在哪里？
3：kafka为什么这么优秀？
4：kafka和其他消息中间件相比有什么特点？
5：kafka的最佳实践？
6：老师是怎么研究kafka的？怎么像老师一样优秀？
2019-08-10



流浪的阳光
老师您好，请问kafca适合做两个系统之间的转账处理吗？

另外，请问kafca的使用案例中，最多支持过什么数量级的消费者和生产者。
2019-07-03



乐天
对我有很大启发
2019-07-01



毛尖好喝
kafka小白一枚，刚刷完书还是不太明白，胡老师的课带来很大帮助，纯干货，另外，声音很有磁性，发量不错！
2019-06-27



不能如期而至
学习就找最专业的人，期待老师的课
2019-06-15



guoyinbo2019
项目也在用kafka，也遇到过坑，但是自己了解甚浅，希望通过专栏加深学习。
2019-06-14



吴澎湖
谢谢你的倾囊相授
2019-06-14



大军
正在对系统进行优化，边学边用，期待快速更新.
2019-06-14



清晨吼于林
OK，进入正题，开始学习~
2019-06-11



风中花
期待更多的收获！ 老师 加油！我们加油
2019-06-11



niemo
期待已久
2019-06-10



focus
一行行啃源码，很棒
2019-06-09



周昱江
能否对比IBM MQ等非开源产品?谢谢。
2019-06-06



佑儿
打卡
2019-06-06



蹇小东
打卡学习
2019-06-06



风起青萍
我也想成为大佬。学习
2019-06-05



轻轻风云
最近在学习Kafka，专栏来的刚刚好。
2019-06-04



多多洛
打卡学习
2019-06-04



hellochenpro
运维工程师，期待老师的新课程
2019-06-04



南辕北辙
老师的书读了很多遍，五月看了6月专栏就一直在期待了
2019-06-03



双叶
libkafka是哪个库？librdkafka？
作者回复: 嗯嗯，是的，标准提法就是librdkafka
2019-06-03



Tears灬T
一直想深入学习一下Kafka，但找到的资料太碎太基础，期待这次学习，有个美好的蜕变，学习学习
2019-06-03



二刀田
关注已久，课程一上线，就立马下手了！希望能通过课程对kafka有个系统的理解
2019-06-03



静水流深
看到后直接买了
2019-06-03



涛哥迷妹
非常期待 kafka原理 管理、运维 以及 kafka streams 实操玩法，快点更新吧
2019-06-03



化作春泥
前段时间多次搜索kafka相关课程，一直没有，今天微信收到推送，立即购买
2019-06-03



AF
作为一个大数据开发，直接就下单了哈哈
作者回复: 感谢鼓励和支持：）
2019-06-03



麻瓜编码师
ruby的kafka客户端只有国外zendesk的一个版本，学完课程希望能为这个版本做出pr。
作者回复: 嗯，目前Kafka社区并无专人维护ruby客户端，如果有可能的话尽量使用libkafka
2019-06-03






